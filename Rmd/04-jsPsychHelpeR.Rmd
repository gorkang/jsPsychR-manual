# jsPsychHelpeR {#jsPsychHelpeR}

[jsPsychHelpeR](https://github.com/gorkang/jsPsychHelpeR): Standardize and automatize data preparation and analysis of jsPsych experiments created with jsPsychMaker.


## Como preparar datos

Cada tarea de [jsPsychMaker](https://github.com/gorkang/jsPsychMaker) tendrá un script hermano en [jsPsychHelpeR](https://github.com/gorkang/jsPsychHelpeR) para automatizar la preparación de datos. Una vez tengamos nuestro protocolo listo, con la función `run_initial_setup()` de jsPsychHelpeR crearemos todo lo necesario para que la preparación de datos corra automáticamente.  

---   


1) Descargamos el proyecto de RStudio jsPsychHelpeR

- Abre RStudio y ejecuta las dos lineas de abajo en la Consola. Esto abrirá una nueva ventana con una copia del proyecto jsPsychHelpeR. En la parte superior derecha de RStudio verás algo similar a:  
![](img/jsPsychHelpeR-project.png)

```{r, eval=FALSE}

# Se asegura que el paquete {usethis} está instalado
if (!require('usethis')) install.packages('usethis'); library('usethis')

# Descargamos jsPsychHelpeR a la carpeta Downloads
usethis::use_course(url = "gorkang/jsPsychHelpeR", destdir = "~/Downloads/")

# En la consola aparecerá la pregunta: 'Shall we delete the ZIP file ('gorkang-jsPsychHelpeR-123fa42.zip')?
  # Puedes decirle que SI

```


2) Abrimos el archivo `run.R` y seguimos las instrucciones.  

![](img/files-pane_run.png)


```{r, eval=FALSE}

# Cargamos las funciones
invisible(lapply(list.files("./R", full.names = TRUE, pattern = ".R$"), source))

# Corremos el setup inicial [RECUERDA reemplazar `999` con el número de tu proyecto]
run_initial_setup(pid = 999)

# Finalmente, corremos la preparación de datos
targets::tar_make()

```

`run_initial_setup()` hará lo siguiente:

- Borrar archivos antiguos
- Instalar dependencias
- Crear carpetas necesarias
- Descargar archivos de resultados del proyecto `solo en Ubuntu`
- Crear un archivo `_targets.R` adaptado a los archivos del proyecto

---  


## ERRORES comunes

Si te aparecen los siguientes errores al correr `run_initial_setup()`:  

```
x Can find server credentials in '.vault/.credentials'
x 0 tasks found for protocol 'TU NUMERO DE PROYECTO'. NOT creating _targets.R file
```

### Si estas en Linux (Ubuntu):

- Tienes las credenciales para acceder al servidor: 

  + Abre .credentials_TEMPLATE `rstudioapi::navigateToFile(".vault/.credentials_TEMPLATE")`
  
  + Introduce los detalles para conectarte al servidor
  
  + Renombra el archivo a `.credentials`
  
---  

  
- NO tienes las credenciales pero si los archivos .csv de resultados:

  + Descarga los archivos del servidor a la carpeta `data/TU NUMERO DE PROYECTO`
  
  + Vuelve a correr `run_initial_setup()`

### Si estas en Windows o Mac:

- Descarga los archivos del servidor a la carpeta `data/TU NUMERO DE PROYECTO`
- Vuelve a correr `run_initial_setup()`